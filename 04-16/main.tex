
\documentclass[a4paper,11pt]{article}
\usepackage[a4paper, margin=8em]{geometry}

% usa i pacchetti per la scrittura in italiano
\usepackage[french,italian]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\frenchspacing 

% usa i pacchetti per la formattazione matematica
\usepackage{amsmath, amssymb, amsthm, amsfonts}

% usa altri pacchetti
\usepackage{gensymb}
\usepackage{hyperref}
\usepackage{standalone}

% imposta il titolo
\title{Appunti Fondamenti di Automatica}
\author{Luca Seggiani}
\date{2025}

% disegni
\usepackage{pgfplots}
\pgfplotsset{width=10cm,compat=1.9}

% imposta lo stile
% usa helvetica
\usepackage[scaled]{helvet}
% usa palatino
\usepackage{palatino}
% usa un font monospazio guardabile
\usepackage{lmodern}

% tikz in sans
\tikzset{every picture/.style={/utils/exec={\sffamily}}}

\renewcommand{\rmdefault}{ppl}
\renewcommand{\sfdefault}{phv}
\renewcommand{\ttdefault}{lmtt}

% circuiti
\usepackage{circuitikz}
\usetikzlibrary{babel}

% disponi il titolo
\makeatletter
\renewcommand{\maketitle} {
	\begin{center} 
		\begin{minipage}[t]{.8\textwidth}
			\textsf{\huge\bfseries \@title} 
		\end{minipage}%
		\begin{minipage}[t]{.2\textwidth}
			\raggedleft \vspace{-1.65em}
			\textsf{\small \@author} \vfill
			\textsf{\small \@date}
		\end{minipage}
		\par
	\end{center}

	\thispagestyle{empty}
	\pagestyle{fancy}
}
\makeatother

% disponi teoremi
\usepackage{tcolorbox}
\newtcolorbox[auto counter, number within=section]{theorem}[2][]{%
	colback=blue!10, 
	colframe=blue!40!black, 
	sharp corners=northwest,
	fonttitle=\sffamily\bfseries, 
	title=Teorema~\thetcbcounter: #2, 
	#1
}

% disponi definizioni
\newtcolorbox[auto counter, number within=section]{definition}[2][]{%
	colback=red!10,
	colframe=red!40!black,
	sharp corners=northwest,
	fonttitle=\sffamily\bfseries,
	title=Definizione~\thetcbcounter: #2,
	#1
}

% disponi problemi
\newtcolorbox[auto counter, number within=section]{problem}[2][]{%
	colback=green!10,
	colframe=green!40!black,
	sharp corners=northwest,
	fonttitle=\sffamily\bfseries,
	title=Problema~\thetcbcounter: #2,
	#1
}

% disponi codice
\usepackage{listings}
\usepackage[table]{xcolor}

\lstdefinestyle{codestyle}{
	backgroundcolor=\color{black!5}, 
	commentstyle=\color{codegreen},
	keywordstyle=\bfseries\color{magenta},
	numberstyle=\sffamily\tiny\color{black!60},
	stringstyle=\color{green!50!black},
	basicstyle=\ttfamily\footnotesize,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2
}

\lstdefinestyle{shellstyle}{
	backgroundcolor=\color{black!5}, 
	basicstyle=\ttfamily\footnotesize\color{black}, 
	commentstyle=\color{black}, 
	keywordstyle=\color{black},
	numberstyle=\color{black!5},
	stringstyle=\color{black}, 
	showspaces=false,
	showstringspaces=false, 
	showtabs=false, 
	tabsize=2, 
	numbers=none, 
	breaklines=true
}

\lstdefinelanguage{javascript}{
	keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break},
	keywordstyle=\color{blue}\bfseries,
	ndkeywords={class, export, boolean, throw, implements, import, this},
	ndkeywordstyle=\color{darkgray}\bfseries,
	identifierstyle=\color{black},
	sensitive=false,
	comment=[l]{//},
	morecomment=[s]{/*}{*/},
	commentstyle=\color{purple}\ttfamily,
	stringstyle=\color{red}\ttfamily,
	morestring=[b]',
	morestring=[b]"
}

% disponi sezioni
\usepackage{titlesec}

\titleformat{\section}
{\sffamily\Large\bfseries} 
{\thesection}{1em}{} 
\titleformat{\subsection}
{\sffamily\large\bfseries}   
{\thesubsection}{1em}{} 
\titleformat{\subsubsection}
{\sffamily\normalsize\bfseries} 
{\thesubsubsection}{1em}{}

% disponi alberi
\usepackage{forest}

\forestset{
	rectstyle/.style={
		for tree={rectangle,draw,font=\large\sffamily}
	},
	roundstyle/.style={
		for tree={circle,draw,font=\large}
	}
}

% disponi algoritmi
\usepackage{algorithm}
\usepackage{algorithmic}
\makeatletter
\renewcommand{\ALG@name}{Algoritmo}
\makeatother

% disponi numeri di pagina
\usepackage{fancyhdr}
\fancyhf{} 
\fancyfoot[L]{\sffamily{\thepage}}

\makeatletter
\fancyhead[L]{\raisebox{1ex}[0pt][0pt]{\sffamily{\@title \ \@date}}} 
\fancyhead[R]{\raisebox{1ex}[0pt][0pt]{\sffamily{\@author}}}
\makeatother

\begin{document}

% sezione (data)
\section{Lezione del 16-04-25}

% stili pagina
\thispagestyle{empty}
\pagestyle{fancy}

% testo
Riprendiamo il discorso sul luogo delle radici, con maggiore attenzione su come \textit{tarare} (ottenere informazioni riguardo al modulo) i punti $s$.

\subsubsection{Taratura del luogo delle radici}
Abbiamo visto nella scorsa lezione come applicando la \textit{condizione di fase} possiamo tracciare tutto il luogo delle radici, diretto ed inverso.
Abbiamo poi introdotto come l'altra condizione, la \textit{condizione di modulo}, può essere usata per ottenere il modulo corrispondente ad un punto $s_i$ che già sappiamo appartenere al luogo delle radici.

Questa era quindi la condizione, che valutiamo nel punto $s_i$:
$$
\left| \frac{n(s)}{d(s)} \right| = \frac{1}{|K|} \xrightarrow{s_i} |K| \big|_{s = s_i} = \left| \frac{d(s_i)}{n(s_i)} \right|
$$

Riprendiamo l'esempio della scorsa lezione, che era:
$$
K \cdot G(s) = \frac{K}{s (s + 1)}
$$

Avremo quindi, applicando la condizione di modulo:
$$
|K| \big|_{s = s_i} = \frac{|s_i (s_i + 1)|}{|1|}
$$

Prendiamo ad esempio il punto che sta all'intersezione fra i due rami che avevamo individuato nel luogo diretto, cioè $s_i = -\frac{1}{2}$.
In questo caso avremo che il modulo di $K$ è:
$$
|K| \Big|_{s_i = -\frac{1}{2}} = \frac{\left|-\frac{1}{2} (-\frac{1}{2} + 1)\right|}{|1|} = \frac{1}{4}
$$

\subsection{Luogo delle radici complesse e coniugate}
Veniamo quindi a come tracciare i luoghi delle radici di sistemi del second'ordine.
Prendiamo quindi un nuovo esempio, che è la classica forma di Evans al secondo grado:
$$
G(s) = \frac{\omega_0^2}{s^2 + 2 \xi \omega_0 s + \omega_0 ^2}
$$
Le radici di questa sono note e valgono:
$$
p_{1, 2} = -\xi \omega_0 \pm \omega_0 j \sqrt{1 - \xi^2}
$$

\subsubsection{Valutazione di frequenza e smorzamento}

Vediamo quali informazioni sul sistema possiamo ottenere osservando le radici.

Prendendo quindi un punto all'origine nel piano di Gauss del luogo delle radici, e quindi l'angolo $\theta$ che la congiungente del punto e la radice a parte immaginaria positiva forma con l'asse immaginario, potremo dire:
$$
\omega_0 \sin(\theta) = \xi \omega_0 \implies \theta = \sin^{-1} (\xi) 
$$
cioè l'angolo $\theta$ va più o meno come lo smorzamento.

Di contro, considerando smorzamente fisso, si ha che la distanza dall'origine equivale alla frequenza naturale.
Infatti avremo che:
$$
\sqrt{ \xi^2 \omega_0^2 + \omega_0^2 (1 - \xi^2) } = \omega_0
$$

Riassumendo, quindi, si ha che:
\begin{itemize}
	\item $\xi = 0$: (\textit{smorzamento nullo}) i poli sono sull'asse immaginario;
	\item $\xi = 1$: (\textit{smorzamento perfetto})  i poli sono sul'asse reale e coincidenti;
	\item $0 < \xi < 1$: (\textit{sistema sottosmorzato}) i poli sono sulla semicirconferenza sinistra (uno in $\mathbb{C}^+$, l'altro in $\mathbb{C}^-$) di raggio $\omega_0$ centrata sull'origine.
	\item Il modulo delle radici corrisponde alla frequenza naturale $\omega_0$.
\end{itemize}

\subsubsection{Linee costanti}
Esistono diverse linee costanti che possiamo percorrere (cioè su cui possiamo posizionare i poli) in modo da mantenere certe caratteristiche del sistema costanti:
\begin{itemize}
	\item 
		Abbiamo quindi che percorrendo una retta passante per l'origine nella direzione negativa dell'asse complesso si ottiene una cosiddetta \textbf{linea di smorzamento costante}, cioè un insieme di regioni dove lo smorzamento resta costante e cambia invece (con l'aumentare della distanza dall'origine) la frequenza naturale. 
	\item
		Per mantenere costante il tempo di assestamento, invece, basta mantenere la componente reale dei poli costante, ergo si crea una cosiddetta \textbf{linea di tempo di assestamento costante} parallela all'asse immaginario. # grafici, sia dei punti che delle risposte tempo campionando le linee

		# non ci dovrebbero essere anche linee di pulsazione naturale costante?
\end{itemize}

\subsubsection{Regioni di vincolo}
Abbiamo parlato finora dei soli poli: vediamo di reintrodurre il sistema con controllore ($K$). 

Intanto possiamo vedere alcuni vincoli di progetto che potremmo avere sul comportamento desiderato:
\begin{itemize}
	\item 
		Intanto potremmo volere che lo \textbf{smorzamento} che otterremo non sia mai minore di un certo valore. Saremo vincolati ad un cono di angolo $\theta$ con l'asse immaginario, che possiamo individuare sul piano di Argand-Gauss: # grafico

	\item
		Se volessimo invece \textbf{tempo di assestamento} sotto una certa soglia, vorremo trovarci a sinistra di una linea di tempo di assestamento costante, quindi in una regione di piano che il seguente aspetto: #grafico

	\item
		Infine potremmo voler vincolare la pulsazione naturale.
		In questo caso, direttamente dalla corrispondenza fra modulo e pulsazione naturale, ci vorremmo restiringere, ad esempio se si vuole pulsazione \textit{maggiore} (\textit{minore}) di una certa soglia, alla regione \textit{esterna} (\textit{interna}) ad una certa circonferenza di raggio equivalente alla soglia.
\end{itemize}

L'insieme dei punti che rispettano tutti i vincoli si ha, a questo punto, semplicemente prendendo l'intersezione delle regioni individuate da ogni vincolo.

\subsubsection{Regole di tracciamento 2}
Vediamo quindi altre regole di tracciamento.

\begin{enumerate}
	\item[5.] La regola (5) riguarda le \textit{sovrapposizioni} di rami.
		In particolare, si ha che i rami non si sovrappongono mai, se non in punti singolari detti \textbf{punti multipli}, in quanto rappresentano \textit{radici multiple} del polinomio caratteristico.

		In un punto multiplo la radice multipla $s_i$ è soluzione di:
		\[
			\begin{cases}
				d(s) + Kn(s) = 0 \\
				d'(s) + K n'(s) = 0
			\end{cases}
		\]
		cioè dell'equazione caratteristica e della sua derivata.

		Inoltre, si nota che:
		$$
		\sum_{i = 1}^n \frac{1}{s - p_i} = \sum_{i = 1}^m \frac{1}{s - z_i}
		$$

		\par\medskip
		\noindent
		\textbf{\sffamily{Esempio}}

		Avevamo già visto questa situazione nel primo esempio di tracciamento, cioè:
		$$
		K \cdot G(s) = \frac{K}{s(s+1)}
		$$

		Vediamo infatti che risolvendo:
		$$
		\sum_{i = 1}^n \frac{1}{s - p_i} = \sum_{i = 1}^m \frac{1}{s - z_i}
		\implies \frac{1}{s} + \frac{1}{s + 1} = 0
		$$
		si ottiene la soluzione:
		$$
		s_i = -\frac{1}{2}
		$$
		che avevamo visto era esattamente un punto di intersezione fra rami (in particolare quello reale e immaginario nel luogo diretto).

	\item[6.] La regola (6) si concentra sul \textit{comportamento asintotico}, cioè su cosa accade per $K \rightarrow +\infty$.
		Avevamo anticipato che in questo caso i poli andavano al \textit{finito} (cioè agli zeri della funzione a ciclo aperto) o ad \textit{infinito}.
		Per quanto riguardava i poli ad infinito, avevamo detto che questi erano $n - m$ (cioè quelli che non andavano in zeri in ciclo aperto).
		Chiamiamo questo valore $v = n - m$, o \textit{differenza poli-zeri}.

		# qui c'era una regolina sugli angoli, il metodo sotto è un'alternativa (migliore)

		Nota la differenza poli-zeri potremo allora dire che:
		\begin{itemize}
			\item Esiste un \textbf{centro degli asintoti}, cioè il punto da cui iniziamo a tracciare gli asintoti, che sta sempre sull'asse reale ed è:
				$$
				\sigma = \frac{ \sum_{i = 1}^n p_i - \sum_{i = 1}^m z_i }{v}
				$$

			\item Gli asintoti dividono quindi il piano di Argand-Gauss in sezioni equiangole, cioè si hano gli \textbf{angoli di asintoto}:
				\[
					\phi_\text{asintoto} =
					\begin{cases}
						\frac{-\pi \pm 2 h \pi}{v}, \quad K > 0 \\
						\frac{2 h \pi}{v}, \quad K < 0 \\
					\end{cases}
				\]
		\end{itemize}

		\par\medskip
		\noindent
		\textbf{\sffamily{Esempio 1}}

		Vediamo la funzione di trasferimento di esempio:
		$$
		G(s) = \frac{1}{(s + 1)^3}
		$$
		in questo caso avremo il centro degli asintoti:
		$$
		\sigma = \frac{-1 -1 -1}{3} = -1
		$$
		e gli angoli di asintoto, rispettivamente per il luogo diretto e inverso:
		$$
		\phi_{asintoto} = \left\{ 60^\circ, 180^\circ, 300^\circ \right\}, \quad K > 0
		$$
		$$
		\phi_{asintoto} = \left\{ 0^\circ, 120^\circ, 240^\circ \right\}, \quad K < 0
		$$
		Notiamo che questi angoli non sono stati calcolati usando la formula, ma semplicemente notando di dover dividere, per $v = 3$, il piano di Argand-Gauss in regioni equiangole di angolo $120^\circ$.

		\par\medskip
		\noindent
		\textbf{\sffamily{Esempio 2}}

		Vediamo un'altro esempio, attraverso la funzione di trasferimento:
		$$
		g(s) = \frac{1}{s(s + 1)(s + 2)}
		$$
		In questo caso l'equazione caratteristica sarà:
		$$
		1 + K \cdot G(s) = s ( s + 1) ( s + 2) + K = s^3 + 3s^2 + 2s + K = 0
		$$

		Potrebbe interessarci valutare la stablità.
		In questo caso potremmo sfruttare il \textit{criterio di Routh}:
		\begin{table}[H]
			\center 
			\begin{tabular} { c | c c}
				$3$ & $1$ & $2$ \\
				$2$ & $3$ & $K$ \\
				$1$ & $6 - K$ & $0$ \\
				$0$ & $K$
			\end{tabular}
		\end{table}
		da cui la $K$ critica $K_{CR} = 6$, e quindi sistema stabile per $0 < K < 6$.

		Proseguiamo quindi col tracciamento.
		Avremo che i poli sono $p_1 = -2$, $p_2 = -1$ e $p3 = 0$
		Dalla regola (4), quindi, apparterranno al luogo diretto i punti in $(-\infty, -2]$, e i punti in $[-1, 0]$.

		Avremo quindi $v = n - m = 3$ (non ci sono zeri),  e quindi 3 asintoti (di cui uno è quello reale).
		Vorremo quindi gli angoli di asintoto (sempre in luogo diretto):
		$$
		\phi_\text{asintoto} = \left\{ 60^\circ, 180^\circ, 300^\circ \right\}
		$$
		e il centro degli asintoti:
		$$
		\sigma = \frac{0 -1 -2}{3} = -1
		$$
		cioè sul piano complesso ci saranno due asintoti che si staccano da $-1$ e proseguono formando angoli di $60^\circ$ e $-60\circ$ con l'asse reale. # grafici di questi esempi

		\par\medskip
		\noindent
		\textbf{\sffamily{Esempio 3}}

		Prendiamo il caso di avere 2 poli ed uno zero finito.
		In questo caso il luogo delle radici è una circonferenza centrata sullo zero.
		Questo si verifica dalla condizione di fase:
		$$
		\alpha - 2 \beta = - \pi \pm 2 h \pi
		$$
		in quanto questa si può ricavare dando l'identità, vera su una circonferenza:
		$$ # riguarda
		\frac{\alpha}{2} + \frac{\pi}{2} + \gamma = \pi \Rightarrow \frac{\alpha}{2} + \frac{\pi_2} + \pi + \beta = - \pi \Rightarrow \alpha - 2 \beta = \pi
		$$
		e ponendo $h = 0$.

		Avremo quindi che i due poli, se sono reali, sono obbligatoriamente sovrapposti.
		Altrimenti, si sposteranno lungo la circonferenza, vincolandone gli estremi. # riguarda riguarda riguarda + grafico

	\item[7.] La regola (7) riguarda gli angoli di partenza dei rami uscenti dai poli.
		Avevamo che i rami uscenti dai poli con molteplicità $> 1$ dividono il piano in parti equiangole e simmetriche rispetto all'asse reale.

		Iniziamo dalla condizione di fase:
		$$
		\angle n(s) - \angle d(s) = - \pi, \quad K > 0
		$$
		e consideriamo il polinomio $d^*(s)$:
		$$
		d*(s) = \frac{d(s)}{s - p_1}
		$$
		Allora varrà che:
		$$
		\theta_{p_1} = \pi + \angle n(s) - \angle d^*(s)
		$$
		# e varrà anche che mi sono rotto i coglioni finisco dopo
\end{enumerate}

\end{document}
